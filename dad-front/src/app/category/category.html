<div class="categories-container">
  <div class="categories-header">
    <div class="header-content">
      <h2>Gesti√≥n de Categor√≠as</h2>
      <p>Administra las categor√≠as de productos</p>
    </div>
    <button class="btn btn-primary" (click)="openCreateForm()" [disabled]="loading">
      + Nueva Categor√≠a
    </button>
  </div>

  <!-- Alert Messages -->
  <div *ngIf="success" class="alert alert-success">
    {{ success }}
    <button class="alert-close" (click)="clearMessages()">√ó</button>
  </div>
  
  <div *ngIf="error" class="alert alert-error">
    {{ error }}
    <button class="alert-close" (click)="clearMessages()">√ó</button>
  </div>

  <!-- Create/Edit Form -->
  <div *ngIf="showForm" class="form-overlay">
    <div class="form-modal">
      <div class="form-header">
        <h3>{{ isEditing ? 'Editar Categor√≠a' : 'Nueva Categor√≠a' }}</h3>
        <button class="close-btn" (click)="closeForm()">√ó</button>
      </div>
      
      <form [formGroup]="categoryForm" (ngSubmit)="onSubmit()" class="category-form">
        <div class="form-group">
          <label for="nombre">Nombre *</label>
          <input
            type="text"
            id="nombre"
            formControlName="nombre"
            class="form-control"
            [class.error]="categoryForm.get('nombre')?.invalid && categoryForm.get('nombre')?.touched"
            placeholder="Nombre de la categor√≠a"
          />
          <div *ngIf="categoryForm.get('nombre')?.invalid && categoryForm.get('nombre')?.touched" class="error-message">
            <span *ngIf="categoryForm.get('nombre')?.errors?.['required']">El nombre es requerido</span>
            <span *ngIf="categoryForm.get('nombre')?.errors?.['minlength']">El nombre debe tener al menos 2 caracteres</span>
          </div>
        </div>

        <div class="form-group">
          <label for="descripcion">Descripci√≥n</label>
          <textarea
            id="descripcion"
            formControlName="descripcion"
            class="form-control"
            rows="3"
            placeholder="Descripci√≥n de la categor√≠a (opcional)"
          ></textarea>
        </div>

        <div class="form-actions">
          <button type="button" class="btn btn-secondary" (click)="closeForm()" [disabled]="loading">
            Cancelar
          </button>
          <button type="submit" class="btn btn-primary" [disabled]="categoryForm.invalid || loading">
            <span *ngIf="loading">Guardando...</span>
            <span *ngIf="!loading">{{ isEditing ? 'Actualizar' : 'Crear' }}</span>
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Categories List -->
  <div class="categories-content">
    <div *ngIf="loading && categories.length === 0" class="loading-container">
      <div class="loading-spinner"></div>
      <p>Cargando categor√≠as...</p>
    </div>

    <div *ngIf="!loading && categories.length === 0" class="empty-state">
      <div class="empty-icon">üìÅ</div>
      <h3>No hay categor√≠as</h3>
      <p>Crea tu primera categor√≠a para comenzar a organizar tus productos</p>
      <button class="btn btn-primary" (click)="openCreateForm()">
        + Crear Primera Categor√≠a
      </button>
    </div>

    <div *ngIf="categories.length > 0" class="categories-grid">
      <div *ngFor="let category of categories" class="category-card">
        <div class="category-info">
          <h3>{{ category.nombre }}</h3>
          <p>{{ category.descripcion || 'Sin descripci√≥n' }}</p>
          <div class="category-meta">
            <span class="category-id">ID: {{ category.id }}</span>
          </div>
        </div>
        
        <div class="category-actions">
          <button 
            class="btn-icon edit" 
            (click)="openEditForm(category)" 
            [disabled]="loading"
            title="Editar categor√≠a"
          >
            ‚úèÔ∏è
          </button>
          <button 
            class="btn-icon delete" 
            (click)="deleteCategory(category)" 
            [disabled]="loading"
            title="Eliminar categor√≠a"
          >
            üóëÔ∏è
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
